/**
 * jQuery EasyUI 1.3.6
 * 
 * Copyright (c) 2009-2014 www.jeasyui.com. All rights reserved.
 *
 * Licensed under the GPL license: http://www.gnu.org/licenses/gpl.txt
 * To use it on other terms please contact us at info@jeasyui.com
 *
 */

(function($){function init(a){function d(b){var c=[];return b.addClass("menu"),c.push(b),b.hasClass("menu-content")||b.children("div").each(function(){var b=$(this).children("div");if(b.length){b.insertAfter(a),this.submenu=b;var e=d(b);c=c.concat(e)}}),c}function e(b){var c=$.parser.parseOptions(b[0],["width","height"]);b[0].originalHeight=c.height||0,b.hasClass("menu-content")?b[0].originalWidth=c.width||b._outerWidth():(b[0].originalWidth=c.width||0,b.children("div").each(function(){var b=$(this),c=$.extend({},$.parser.parseOptions(this,["name","iconCls","href",{separator:"boolean"}]),{disabled:b.attr("disabled")?!0:undefined});c.separator&&b.addClass("menu-sep");if(!b.hasClass("menu-sep")){b[0].itemName=c.name||"",b[0].itemHref=c.href||"";var d=b.addClass("menu-item").html();b.empty().append($('<div class="menu-text"></div>').html(d)),c.iconCls&&$('<div class="menu-icon"></div>').addClass(c.iconCls).appendTo(b),c.disabled&&setDisabled(a,b[0],!0),b[0].submenu&&$('<div class="menu-rightarrow"></div>').appendTo(b),bindMenuItemEvent(a,b)}}),$('<div class="menu-line"></div>').prependTo(b)),setMenuWidth(a,b),b.hide(),bindMenuEvent(a,b)}$(a).appendTo("body"),$(a).addClass("menu-top"),$(document).unbind(".menu").bind("mousedown.menu",function(a){var b=$(a.target).closest("div.menu,div.combo-p");if(b.length)return;$("body>div.menu-top:visible").menu("hide")});var b=d($(a));for(var c=0;c<b.length;c++)e(b[c])}function setMenuWidth(a,b){var c=$.data(a,"menu").options,d=b.attr("style")||"";b.css({display:"block",left:-1e4,height:"auto",overflow:"hidden"});var e=b[0],f=e.originalWidth||0;f||(f=0,b.find("div.menu-text").each(function(){f<$(this)._outerWidth()&&(f=$(this)._outerWidth()),$(this).closest("div.menu-item")._outerHeight($(this)._outerHeight()+2)}),f+=40),f=Math.max(f,c.minWidth);var g=e.originalHeight||b.outerHeight(),h=Math.max(e.originalHeight,b.outerHeight())-2;b._outerWidth(f)._outerHeight(g),b.children("div.menu-line")._outerHeight(h),d+=";width:"+e.style.width+";height:"+e.style.height,b.attr("style",d)}function bindMenuEvent(a,b){var c=$.data(a,"menu");b.unbind(".menu").bind("mouseenter.menu",function(){c.timer&&(clearTimeout(c.timer),c.timer=null)}).bind("mouseleave.menu",function(){c.options.hideOnUnhover&&(c.timer=setTimeout(function(){hideAll(a)},100))})}function bindMenuItemEvent(a,b){if(!b.hasClass("menu-item"))return;b.unbind(".menu"),b.bind("click.menu",function(){if($(this).hasClass("menu-item-disabled"))return;if(!this.submenu){hideAll(a);var b=$(this).attr("href");b&&(location.href=b)}var c=$(a).menu("getItem",this);$.data(a,"menu").options.onClick.call(a,c)}).bind("mouseenter.menu",function(c){b.siblings().each(function(){this.submenu&&hideMenu(this.submenu),$(this).removeClass("menu-active")}),b.addClass("menu-active");if($(this).hasClass("menu-item-disabled")){b.addClass("menu-active-disabled");return}var d=b[0].submenu;d&&$(a).menu("show",{menu:d,parent:b})}).bind("mouseleave.menu",function(a){b.removeClass("menu-active menu-active-disabled");var c=b[0].submenu;c?a.pageX>=parseInt(c.css("left"))?b.addClass("menu-active"):hideMenu(c):b.removeClass("menu-active")})}function hideAll(a){var b=$.data(a,"menu");return b&&$(a).is(":visible")&&(hideMenu($(a)),b.options.onHide.call(a)),!1}function showMenu(a,b){var c,d;b=b||{};var e=$(b.menu||a);if(e.hasClass("menu-top")){var f=$.data(a,"menu").options;$.extend(f,b),c=f.left,d=f.top;if(f.alignTo){var g=$(f.alignTo);c=g.offset().left,d=g.offset().top+g._outerHeight(),f.align=="right"&&(c+=g.outerWidth()-e.outerWidth())}c+e.outerWidth()>$(window)._outerWidth()+$(document)._scrollLeft()&&(c=$(window)._outerWidth()+$(document).scrollLeft()-e.outerWidth()-5),c<0&&(c=0),d+e.outerHeight()>$(window)._outerHeight()+$(document).scrollTop()&&(d=$(window)._outerHeight()+$(document).scrollTop()-e.outerHeight()-5)}else{var h=b.parent;c=h.offset().left+h.outerWidth()-2,c+e.outerWidth()+5>$(window)._outerWidth()+$(document).scrollLeft()&&(c=h.offset().left-e.outerWidth()+2);var d=h.offset().top-3;d+e.outerHeight()>$(window)._outerHeight()+$(document).scrollTop()&&(d=$(window)._outerHeight()+$(document).scrollTop()-e.outerHeight()-5)}e.css({left:c,top:d}),e.show(0,function(){e[0].shadow||(e[0].shadow=$('<div class="menu-shadow"></div>').insertAfter(e)),e[0].shadow.css({display:"block",zIndex:$.fn.menu.defaults.zIndex++,left:e.css("left"),top:e.css("top"),width:e.outerWidth(),height:e.outerHeight()}),e.css("z-index",$.fn.menu.defaults.zIndex++),e.hasClass("menu-top")&&$.data(e[0],"menu").options.onShow.call(e[0])})}function hideMenu(a){function b(a){a.stop(!0,!0),a[0].shadow&&a[0].shadow.hide(),a.hide()}if(!a)return;b(a),a.find("div.menu-item").each(function(){this.submenu&&hideMenu(this.submenu),$(this).removeClass("menu-active")})}function findItem(a,b){function e(f){f.children("div.menu-item").each(function(){var f=$(a).menu("getItem",this),g=d.empty().html(f.text).text();b==$.trim(g)?c=f:this.submenu&&!c&&e(this.submenu)})}var c=null,d=$("<div></div>");return e($(a)),d.remove(),c}function setDisabled(a,b,c){var d=$(b);if(!d.hasClass("menu-item"))return;c?(d.addClass("menu-item-disabled"),b.onclick&&(b.onclick1=b.onclick,b.onclick=null)):(d.removeClass("menu-item-disabled"),b.onclick1&&(b.onclick=b.onclick1,b.onclick1=null))}function appendItem(target,param){var menu=$(target);if(param.parent){if(!param.parent.submenu){var submenu=$('<div class="menu"><div class="menu-line"></div></div>').appendTo("body");submenu.hide(),param.parent.submenu=submenu,$('<div class="menu-rightarrow"></div>').appendTo(param.parent)}menu=param.parent.submenu}if(param.separator)var item=$('<div class="menu-sep"></div>').appendTo(menu);else{var item=$('<div class="menu-item"></div>').appendTo(menu);$('<div class="menu-text"></div>').html(param.text).appendTo(item)}param.iconCls&&$('<div class="menu-icon"></div>').addClass(param.iconCls).appendTo(item),param.id&&item.attr("id",param.id),param.name&&(item[0].itemName=param.name),param.href&&(item[0].itemHref=param.href),param.onclick&&(typeof param.onclick=="string"?item.attr("onclick",param.onclick):item[0].onclick=eval(param.onclick)),param.handler&&(item[0].onclick=eval(param.handler)),param.disabled&&setDisabled(target,item[0],!0),bindMenuItemEvent(target,item),bindMenuEvent(target,menu),setMenuWidth(target,menu)}function removeItem(a,b){function c(a){if(a.submenu){a.submenu.children("div.menu-item").each(function(){c(this)});var b=a.submenu[0].shadow;b&&b.remove(),a.submenu.remove()}$(a).remove()}c(b)}function destroyMenu(a){$(a).children("div.menu-item").each(function(){removeItem(a,this)}),a.shadow&&a.shadow.remove(),$(a).remove()}$.fn.menu=function(a,b){return typeof a=="string"?$.fn.menu.methods[a](this,b):(a=a||{},this.each(function(){var b=$.data(this,"menu");b?$.extend(b.options,a):(b=$.data(this,"menu",{options:$.extend({},$.fn.menu.defaults,$.fn.menu.parseOptions(this),a)}),init(this)),$(this).css({left:b.options.left,top:b.options.top})}))},$.fn.menu.methods={options:function(a){return $.data(a[0],"menu").options},show:function(a,b){return a.each(function(){showMenu(this,b)})},hide:function(a){return a.each(function(){hideAll(this)})},destroy:function(a){return a.each(function(){destroyMenu(this)})},setText:function(a,b){return a.each(function(){$(b.target).children("div.menu-text").html(b.text)})},setIcon:function(a,b){return a.each(function(){$(b.target).children("div.menu-icon").remove(),b.iconCls&&$('<div class="menu-icon"></div>').addClass(b.iconCls).appendTo(b.target)})},getItem:function(a,b){var c=$(b),d={target:b,id:c.attr("id"),text:$.trim(c.children("div.menu-text").html()),disabled:c.hasClass("menu-item-disabled"),name:b.itemName,href:b.itemHref,onclick:b.onclick},e=c.children("div.menu-icon");if(e.length){var f=[],g=e.attr("class").split(" ");for(var h=0;h<g.length;h++)g[h]!="menu-icon"&&f.push(g[h]);d.iconCls=f.join(" ")}return d},findItem:function(a,b){return findItem(a[0],b)},appendItem:function(a,b){return a.each(function(){appendItem(this,b)})},removeItem:function(a,b){return a.each(function(){removeItem(this,b)})},enableItem:function(a,b){return a.each(function(){setDisabled(this,b,!1)})},disableItem:function(a,b){return a.each(function(){setDisabled(this,b,!0)})}},$.fn.menu.parseOptions=function(a){return $.extend({},$.parser.parseOptions(a,["left","top",{minWidth:"number",hideOnUnhover:"boolean"}]))},$.fn.menu.defaults={zIndex:11e4,left:0,top:0,alignTo:null,align:"left",minWidth:120,hideOnUnhover:!0,onShow:function(){},onHide:function(){},onClick:function(a){}}})(jQuery)