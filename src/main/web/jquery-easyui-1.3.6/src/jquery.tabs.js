/**
 * jQuery EasyUI 1.3.6
 * 
 * Copyright (c) 2009-2014 www.jeasyui.com. All rights reserved.
 *
 * Licensed under the GPL license: http://www.gnu.org/licenses/gpl.txt
 * To use it on other terms please contact us at info@jeasyui.com
 *
 */

(function($){function setScrollers(a){var b=$.data(a,"tabs").options;if(b.tabPosition=="left"||b.tabPosition=="right"||!b.showHeader)return;var c=$(a).children("div.tabs-header"),d=c.children("div.tabs-tool"),e=c.children("div.tabs-scroller-left"),f=c.children("div.tabs-scroller-right"),g=c.children("div.tabs-wrap"),h=c.outerHeight();b.plain&&(h-=h-c.height()),d._outerHeight(h);var i=0;$("ul.tabs li",c).each(function(){i+=$(this).outerWidth(!0)});var j=c.width()-d._outerWidth();i>j?(e.add(f).show()._outerHeight(h),b.toolPosition=="left"?(d.css({left:e.outerWidth(),right:""}),g.css({marginLeft:e.outerWidth()+d._outerWidth(),marginRight:f._outerWidth(),width:j-e.outerWidth()-f.outerWidth()})):(d.css({left:"",right:f.outerWidth()}),g.css({marginLeft:e.outerWidth(),marginRight:f.outerWidth()+d._outerWidth(),width:j-e.outerWidth()-f.outerWidth()}))):(e.add(f).hide(),b.toolPosition=="left"?(d.css({left:0,right:""}),g.css({marginLeft:d._outerWidth(),marginRight:0,width:j})):(d.css({left:"",right:0}),g.css({marginLeft:0,marginRight:d._outerWidth(),width:j})))}function addTools(container){var opts=$.data(container,"tabs").options,header=$(container).children("div.tabs-header");if(opts.tools)if(typeof opts.tools=="string")$(opts.tools).addClass("tabs-tool").appendTo(header),$(opts.tools).show();else{header.children("div.tabs-tool").remove();var tools=$('<div class="tabs-tool"><table cellspacing="0" cellpadding="0" style="height:100%"><tr></tr></table></div>').appendTo(header),tr=tools.find("tr");for(var i=0;i<opts.tools.length;i++){var td=$("<td></td>").appendTo(tr),tool=$('<a href="javascript:void(0);"></a>').appendTo(td);tool[0].onclick=eval(opts.tools[i].handler||function(){}),tool.linkbutton($.extend({},opts.tools[i],{plain:!0}))}}else header.children("div.tabs-tool").remove()}function setSize(a){var b=$.data(a,"tabs"),c=b.options,d=$(a);c.fit?$.extend(c,d._fit()):d._fit(!1),d.width(c.width).height(c.height);var e=$(a).children("div.tabs-header"),f=$(a).children("div.tabs-panels"),g=e.find("div.tabs-wrap"),h=g.find(".tabs");for(var i=0;i<b.tabs.length;i++){var j=b.tabs[i].panel("options"),k=j.tab.find("a.tabs-inner"),l=parseInt(j.tabWidth||c.tabWidth)||undefined;l?k._outerWidth(l):k.css("width",""),k._outerHeight(c.tabHeight),k.css("lineHeight",k.height()+"px")}if(c.tabPosition=="left"||c.tabPosition=="right")e._outerWidth(c.showHeader?c.headerWidth:0),f._outerWidth(d.width()-e.outerWidth()),e.add(f)._outerHeight(c.height),g._outerWidth(e.width()),h._outerWidth(g.width()).css("height","");else{var m=e.children("div.tabs-scroller-left,div.tabs-scroller-right,div.tabs-tool");e._outerWidth(c.width).css("height",""),c.showHeader?(e.css("background-color",""),g.css("height",""),m.show()):(e.css("background-color","transparent"),e._outerHeight(0),g._outerHeight(0),m.hide()),h._outerHeight(c.tabHeight).css("width",""),setScrollers(a);var n=c.height;isNaN(n)?f.height("auto"):f._outerHeight(n-e.outerHeight());var l=c.width;isNaN(l)?f.width("auto"):f._outerWidth(l)}}function setSelectedSize(a){var b=$.data(a,"tabs").options,c=getSelectedTab(a);if(c){var d=$(a).children("div.tabs-panels"),e=b.width=="auto"?"auto":d.width(),f=b.height=="auto"?"auto":d.height();c.panel("resize",{width:e,height:f})}}function wrapTabs(a){var b=$.data(a,"tabs").tabs,c=$(a);c.addClass("tabs-container");var d=$('<div class="tabs-panels"></div>').insertBefore(c);c.children("div").each(function(){d[0].appendChild(this)}),c[0].appendChild(d[0]),$('<div class="tabs-header"><div class="tabs-scroller-left"></div><div class="tabs-scroller-right"></div><div class="tabs-wrap"><ul class="tabs"></ul></div></div>').prependTo(a),c.children("div.tabs-panels").children("div").each(function(c){var d=$.extend({},$.parser.parseOptions(this),{selected:$(this).attr("selected")?!0:undefined}),e=$(this);b.push(e),createTab(a,e,d)}),c.children("div.tabs-header").find(".tabs-scroller-left, .tabs-scroller-right").hover(function(){$(this).addClass("tabs-scroller-over")},function(){$(this).removeClass("tabs-scroller-over")}),c.bind("_resize",function(b,c){var d=$.data(a,"tabs").options;if(d.fit==1||c)setSize(a),setSelectedSize(a);return!1})}function bindEvents(a){function d(a){var b=0;return a.parent().children("li").each(function(c){if(a[0]==this)return b=c,!1}),b}var b=$.data(a,"tabs"),c=b.options;$(a).children("div.tabs-header").unbind().bind("click",function(e){if($(e.target).hasClass("tabs-scroller-left"))$(a).tabs("scrollBy",-c.scrollIncrement);else if($(e.target).hasClass("tabs-scroller-right"))$(a).tabs("scrollBy",c.scrollIncrement);else{var f=$(e.target).closest("li");if(f.hasClass("tabs-disabled"))return;var g=$(e.target).closest("a.tabs-close");if(g.length)closeTab(a,d(f));else if(f.length){var h=d(f),i=b.tabs[h].panel("options");i.collapsible?i.closed?selectTab(a,h):unselectTab(a,h):selectTab(a,h)}}}).bind("contextmenu",function(b){var e=$(b.target).closest("li");if(e.hasClass("tabs-disabled"))return;e.length&&c.onContextMenu.call(a,b,e.find("span.tabs-title").html(),d(e))})}function setProperties(a){var b=$.data(a,"tabs").options,c=$(a).children("div.tabs-header"),d=$(a).children("div.tabs-panels");c.removeClass("tabs-header-top tabs-header-bottom tabs-header-left tabs-header-right"),d.removeClass("tabs-panels-top tabs-panels-bottom tabs-panels-left tabs-panels-right"),b.tabPosition=="top"?c.insertBefore(d):b.tabPosition=="bottom"?(c.insertAfter(d),c.addClass("tabs-header-bottom"),d.addClass("tabs-panels-top")):b.tabPosition=="left"?(c.addClass("tabs-header-left"),d.addClass("tabs-panels-right")):b.tabPosition=="right"&&(c.addClass("tabs-header-right"),d.addClass("tabs-panels-left")),b.plain==1?c.addClass("tabs-header-plain"):c.removeClass("tabs-header-plain"),b.border==1?(c.removeClass("tabs-header-noborder"),d.removeClass("tabs-panels-noborder")):(c.addClass("tabs-header-noborder"),d.addClass("tabs-panels-noborder"))}function createTab(a,b,c){var d=$.data(a,"tabs");c=c||{},b.panel($.extend({},c,{border:!1,noheader:!0,closed:!0,doSize:!1,iconCls:c.icon?c.icon:undefined,onLoad:function(){c.onLoad&&c.onLoad.call(this,arguments),d.options.onLoad.call(a,$(this))}}));var e=b.panel("options"),f=$(a).children("div.tabs-header").find("ul.tabs");e.tab=$("<li></li>").appendTo(f),e.tab.append('<a href="javascript:void(0)" class="tabs-inner"><span class="tabs-title"></span><span class="tabs-icon"></span></a>'),$(a).tabs("update",{tab:b,options:e})}function addTab(a,b){var c=$.data(a,"tabs").options,d=$.data(a,"tabs").tabs;b.selected==undefined&&(b.selected=!0);var e=$("<div></div>").appendTo($(a).children("div.tabs-panels"));d.push(e),createTab(a,e,b),c.onAdd.call(a,b.title,d.length-1),setSize(a),b.selected&&selectTab(a,d.length-1)}function updateTab(a,b){var c=$.data(a,"tabs").selectHis,d=b.tab,e=d.panel("options").title;d.panel($.extend({},b.options,{iconCls:b.options.icon?b.options.icon:undefined}));var f=d.panel("options"),g=f.tab,h=g.find("span.tabs-title"),i=g.find("span.tabs-icon");h.html(f.title),i.attr("class","tabs-icon"),g.find("a.tabs-close").remove(),f.closable?(h.addClass("tabs-closable"),$('<a href="javascript:void(0)" class="tabs-close"></a>').appendTo(g)):h.removeClass("tabs-closable"),f.iconCls?(h.addClass("tabs-with-icon"),i.addClass(f.iconCls)):h.removeClass("tabs-with-icon");if(e!=f.title)for(var j=0;j<c.length;j++)c[j]==e&&(c[j]=f.title);g.find("span.tabs-p-tool").remove();if(f.tools){var k=$('<span class="tabs-p-tool"></span>').insertAfter(g.find("a.tabs-inner"));if($.isArray(f.tools))for(var j=0;j<f.tools.length;j++){var l=$('<a href="javascript:void(0)"></a>').appendTo(k);l.addClass(f.tools[j].iconCls),f.tools[j].handler&&l.bind("click",{handler:f.tools[j].handler},function(a){if($(this).parents("li").hasClass("tabs-disabled"))return;a.data.handler.call(this)})}else $(f.tools).children().appendTo(k);var m=k.children().length*12;f.closable?m+=8:(m-=3,k.css("right","5px")),h.css("padding-right",m+"px")}setSize(a),$.data(a,"tabs").options.onUpdate.call(a,f.title,getTabIndex(a,d))}function closeTab(a,b){var c=$.data(a,"tabs").options,d=$.data(a,"tabs").tabs,e=$.data(a,"tabs").selectHis;if(!exists(a,b))return;var f=getTab(a,b),g=f.panel("options").title,h=getTabIndex(a,f);if(c.onBeforeClose.call(a,g,h)==0)return;var f=getTab(a,b,!0);f.panel("options").tab.remove(),f.panel("destroy"),c.onClose.call(a,g,h),setSize(a);for(var i=0;i<e.length;i++)e[i]==g&&(e.splice(i,1),i--);var j=e.pop();j?selectTab(a,j):d.length&&selectTab(a,0)}function getTab(a,b,c){var d=$.data(a,"tabs").tabs;if(typeof b=="number"){if(b<0||b>=d.length)return null;var e=d[b];return c&&d.splice(b,1),e}for(var f=0;f<d.length;f++){var e=d[f];if(e.panel("options").title==b)return c&&d.splice(f,1),e}return null}function getTabIndex(a,b){var c=$.data(a,"tabs").tabs;for(var d=0;d<c.length;d++)if(c[d][0]==$(b)[0])return d;return-1}function getSelectedTab(a){var b=$.data(a,"tabs").tabs;for(var c=0;c<b.length;c++){var d=b[c];if(d.panel("options").closed==0)return d}return null}function doFirstSelect(a){var b=$.data(a,"tabs"),c=b.tabs;for(var d=0;d<c.length;d++)if(c[d].panel("options").selected){selectTab(a,d);return}selectTab(a,b.options.selected)}function selectTab(a,b){var c=$.data(a,"tabs"),d=c.options,e=c.tabs,f=c.selectHis;if(e.length==0)return;var g=getTab(a,b);if(!g)return;var h=getSelectedTab(a);if(h){if(g[0]==h[0]){setSelectedSize(a);return}unselectTab(a,getTabIndex(a,h));if(!h.panel("options").closed)return}g.panel("open");var i=g.panel("options").title;f.push(i);var j=g.panel("options").tab;j.addClass("tabs-selected");var k=$(a).find(">div.tabs-header>div.tabs-wrap"),l=j.position().left,m=l+j.outerWidth();if(l<0||m>k.width()){var n=l-(k.width()-j.width())/2;$(a).tabs("scrollBy",n)}else $(a).tabs("scrollBy",0);setSelectedSize(a),d.onSelect.call(a,i,getTabIndex(a,g))}function unselectTab(a,b){var c=$.data(a,"tabs"),d=getTab(a,b);if(d){var e=d.panel("options");e.closed||(d.panel("close"),e.closed&&(e.tab.removeClass("tabs-selected"),c.options.onUnselect.call(a,e.title,getTabIndex(a,d))))}}function exists(a,b){return getTab(a,b)!=null}function showHeader(a,b){var c=$.data(a,"tabs").options;c.showHeader=b,$(a).tabs("resize")}$.fn.tabs=function(a,b){return typeof a=="string"?$.fn.tabs.methods[a](this,b):(a=a||{},this.each(function(){var b=$.data(this,"tabs"),c;b?(c=$.extend(b.options,a),b.options=c):($.data(this,"tabs",{options:$.extend({},$.fn.tabs.defaults,$.fn.tabs.parseOptions(this),a),tabs:[],selectHis:[]}),wrapTabs(this)),addTools(this),setProperties(this),setSize(this),bindEvents(this),doFirstSelect(this)}))},$.fn.tabs.methods={options:function(a){var b=a[0],c=$.data(b,"tabs").options,d=getSelectedTab(b);return c.selected=d?getTabIndex(b,d):-1,c},tabs:function(a){return $.data(a[0],"tabs").tabs},resize:function(a){return a.each(function(){setSize(this),setSelectedSize(this)})},add:function(a,b){return a.each(function(){addTab(this,b)})},close:function(a,b){return a.each(function(){closeTab(this,b)})},getTab:function(a,b){return getTab(a[0],b)},getTabIndex:function(a,b){return getTabIndex(a[0],b)},getSelected:function(a){return getSelectedTab(a[0])},select:function(a,b){return a.each(function(){selectTab(this,b)})},unselect:function(a,b){return a.each(function(){unselectTab(this,b)})},exists:function(a,b){return exists(a[0],b)},update:function(a,b){return a.each(function(){updateTab(this,b)})},enableTab:function(a,b){return a.each(function(){$(this).tabs("getTab",b).panel("options").tab.removeClass("tabs-disabled")})},disableTab:function(a,b){return a.each(function(){$(this).tabs("getTab",b).panel("options").tab.addClass("tabs-disabled")})},showHeader:function(a){return a.each(function(){showHeader(this,!0)})},hideHeader:function(a){return a.each(function(){showHeader(this,!1)})},scrollBy:function(a,b){return a.each(function(){function e(){var a=0,b=c.children("ul");return b.children("li").each(function(){a+=$(this).outerWidth(!0)}),a-c.width()+(b.outerWidth()-b.width())}var a=$(this).tabs("options"),c=$(this).find(">div.tabs-header>div.tabs-wrap"),d=Math.min(c._scrollLeft()+b,e());c.animate({scrollLeft:d},a.scrollDuration)})}},$.fn.tabs.parseOptions=function(a){return $.extend({},$.parser.parseOptions(a,["width","height","tools","toolPosition","tabPosition",{fit:"boolean",border:"boolean",plain:"boolean",headerWidth:"number",tabWidth:"number",tabHeight:"number",selected:"number",showHeader:"boolean"}]))},$.fn.tabs.defaults={width:"auto",height:"auto",headerWidth:150,tabWidth:"auto",tabHeight:27,selected:0,showHeader:!0,plain:!1,fit:!1,border:!0,tools:null,toolPosition:"right",tabPosition:"top",scrollIncrement:100,scrollDuration:400,onLoad:function(a){},onSelect:function(a,b){},onUnselect:function(a,b){},onBeforeClose:function(a,b){},onClose:function(a,b){},onAdd:function(a,b){},onUpdate:function(a,b){},onContextMenu:function(a,b,c){}}})(jQuery)