/**
 * jQuery EasyUI 1.3.6
 * 
 * Copyright (c) 2009-2014 www.jeasyui.com. All rights reserved.
 *
 * Licensed under the GPL license: http://www.gnu.org/licenses/gpl.txt
 * To use it on other terms please contact us at info@jeasyui.com
 *
 */

(function(a){function c(b,c){var d=a.data(b,"combobox"),e=d.options,f=d.data;for(var g=0;g<f.length;g++)if(f[g][e.valueField]==c)return g;return-1}function d(b,c){var d=a.data(b,"combobox").options,e=a(b).combo("panel"),f=d.finder.getEl(b,c);if(f.length)if(f.position().top<=0){var g=e.scrollTop()+f.position().top;e.scrollTop(g)}else if(f.position().top+f.outerHeight()>e.height()){var g=e.scrollTop()+f.position().top+f.outerHeight()-e.height();e.scrollTop(g)}}function e(b,c){var e=a.data(b,"combobox").options,g=a(b).combobox("panel"),h=g.children("div.combobox-item-hover");h.length||(h=g.children("div.combobox-item-selected")),h.removeClass("combobox-item-hover");var i="div.combobox-item:visible:not(.combobox-item-disabled):first",j="div.combobox-item:visible:not(.combobox-item-disabled):last";h.length?c=="next"?(h=h.nextAll(i),h.length||(h=g.children(i))):(h=h.prevAll(i),h.length||(h=g.children(j))):h=g.children(c=="next"?i:j);if(h.length){h.addClass("combobox-item-hover");var k=e.finder.getRow(b,h);k&&(d(b,k[e.valueField]),e.selectOnNavigation&&f(b,k[e.valueField]))}}function f(b,c){var d=a.data(b,"combobox").options,e=a(b).combo("getValues");a.inArray(c+"",e)==-1&&(d.multiple?e.push(c):e=[c],h(b,e),d.onSelect.call(b,d.finder.getRow(b,c)))}function g(b,c){var d=a.data(b,"combobox").options,e=a(b).combo("getValues"),f=a.inArray(c+"",e);f>=0&&(e.splice(f,1),h(b,e),d.onUnselect.call(b,d.finder.getRow(b,c)))}function h(b,c,d){var e=a.data(b,"combobox").options,f=a(b).combo("panel");f.find("div.combobox-item-selected").removeClass("combobox-item-selected");var g=[],h=[];for(var i=0;i<c.length;i++){var j=c[i],k=j;e.finder.getEl(b,j).addClass("combobox-item-selected");var l=e.finder.getRow(b,j);l&&(k=l[e.textField]),g.push(j),h.push(k)}a(b).combo("setValues",g),d||a(b).combo("setText",h.join(e.separator))}function i(b,c,d){var e=a.data(b,"combobox"),f=e.options;e.data=f.loadFilter.call(b,c),e.groups=[],c=e.data;var g=a(b).combobox("getValues"),i=[],j=undefined;for(var k=0;k<c.length;k++){var l=c[k],m=l[f.valueField]+"",n=l[f.textField],o=l[f.groupField];o?j!=o&&(j=o,e.groups.push(o),i.push('<div id="'+(e.groupIdPrefix+"_"+(e.groups.length-1))+'" class="combobox-group">'),i.push(f.groupFormatter?f.groupFormatter.call(b,o):o),i.push("</div>")):j=undefined;var p="combobox-item"+(l.disabled?" combobox-item-disabled":"")+(o?" combobox-gitem":"");i.push('<div id="'+(e.itemIdPrefix+"_"+k)+'" class="'+p+'">'),i.push(f.formatter?f.formatter.call(b,l):n),i.push("</div>"),l.selected&&a.inArray(m,g)==-1&&g.push(m)}a(b).combo("panel").html(i.join("")),f.multiple?h(b,g,d):h(b,g.length?[g[g.length-1]]:[],d),f.onLoadSuccess.call(b,c)}function j(b,c,d,e){var f=a.data(b,"combobox").options;c&&(f.url=c),d=d||{};if(f.onBeforeLoad.call(b,d)==0)return;f.loader.call(b,d,function(a){i(b,a,e)},function(){f.onLoadError.apply(this,arguments)})}function k(b,c){var d=a.data(b,"combobox"),e=d.options;e.multiple&&!c?h(b,[],!0):h(b,[c],!0);if(e.mode=="remote")j(b,null,{q:c},!0);else{var f=a(b).combo("panel");f.find("div.combobox-item-selected,div.combobox-item-hover").removeClass("combobox-item-selected combobox-item-hover"),f.find("div.combobox-item,div.combobox-group").hide();var g=d.data,i=[],k=e.multiple?c.split(e.separator):[c];a.map(k,function(c){c=a.trim(c);var f=undefined;for(var h=0;h<g.length;h++){var j=g[h];if(e.filter.call(b,c,j)){var k=j[e.valueField],l=j[e.textField],m=j[e.groupField],n=e.finder.getEl(b,k).show();l.toLowerCase()==c.toLowerCase()&&(i.push(k),n.addClass("combobox-item-selected")),e.groupField&&f!=m&&(a("#"+d.groupIdPrefix+"_"+a.inArray(m,d.groups)).show(),f=m)}}}),h(b,i,!0)}}function l(b){var d=a(b),e=d.combobox("options"),f=d.combobox("panel"),g=f.children("div.combobox-item-hover");if(g.length){var h=e.finder.getRow(b,g),i=h[e.valueField];e.multiple?g.hasClass("combobox-item-selected")?d.combobox("unselect",i):d.combobox("select",i):d.combobox("select",i)}var j=[];a.map(d.combobox("getValues"),function(a){c(b,a)>=0&&j.push(a)}),d.combobox("setValues",j),e.multiple||d.combobox("hidePanel")}function m(c){var e=a.data(c,"combobox"),h=e.options;b++,e.itemIdPrefix="_easyui_combobox_i"+b,e.groupIdPrefix="_easyui_combobox_g"+b,a(c).addClass("combobox-f"),a(c).combo(a.extend({},h,{onShowPanel:function(){a(c).combo("panel").find("div.combobox-item,div.combobox-group").show(),d(c,a(c).combobox("getValue")),h.onShowPanel.call(c)}})),a(c).combo("panel").unbind().bind("mouseover",function(b){a(this).children("div.combobox-item-hover").removeClass("combobox-item-hover");var c=a(b.target).closest("div.combobox-item");c.hasClass("combobox-item-disabled")||c.addClass("combobox-item-hover"),b.stopPropagation()}).bind("mouseout",function(b){a(b.target).closest("div.combobox-item").removeClass("combobox-item-hover"),b.stopPropagation()}).bind("click",function(b){var d=a(b.target).closest("div.combobox-item");if(!d.length||d.hasClass("combobox-item-disabled"))return;var e=h.finder.getRow(c,d);if(!e)return;var i=e[h.valueField];h.multiple?d.hasClass("combobox-item-selected")?g(c,i):f(c,i):(f(c,i),a(c).combo("hidePanel")),b.stopPropagation()})}var b=0;a.fn.combobox=function(b,c){if(typeof b=="string"){var d=a.fn.combobox.methods[b];return d?d(this,c):this.combo(b,c)}return b=b||{},this.each(function(){var c=a.data(this,"combobox");if(c)a.extend(c.options,b),m(this);else{c=a.data(this,"combobox",{options:a.extend({},a.fn.combobox.defaults,a.fn.combobox.parseOptions(this),b),data:[]}),m(this);var d=a.fn.combobox.parseData(this);d.length&&i(this,d)}c.options.data&&i(this,c.options.data),j(this)})},a.fn.combobox.methods={options:function(b){var c=b.combo("options");return a.extend(a.data(b[0],"combobox").options,{originalValue:c.originalValue,disabled:c.disabled,readonly:c.readonly})},getData:function(b){return a.data(b[0],"combobox").data},setValues:function(a,b){return a.each(function(){h(this,b)})},setValue:function(a,b){return a.each(function(){h(this,[b])})},clear:function(b){return b.each(function(){a(this).combo("clear");var b=a(this).combo("panel");b.find("div.combobox-item-selected").removeClass("combobox-item-selected")})},reset:function(b){return b.each(function(){var b=a(this).combobox("options");b.multiple?a(this).combobox("setValues",b.originalValue):a(this).combobox("setValue",b.originalValue)})},loadData:function(a,b){return a.each(function(){i(this,b)})},reload:function(a,b){return a.each(function(){j(this,b)})},select:function(a,b){return a.each(function(){f(this,b)})},unselect:function(a,b){return a.each(function(){g(this,b)})}},a.fn.combobox.parseOptions=function(b){var c=a(b);return a.extend({},a.fn.combo.parseOptions(b),a.parser.parseOptions(b,["valueField","textField","groupField","mode","method","url"]))},a.fn.combobox.parseData=function(b){function e(b,e){var f=a(b),g={};g[d.valueField]=f.attr("value")!=undefined?f.attr("value"):f.text(),g[d.textField]=f.text(),g.selected=f.is(":selected"),g.disabled=f.is(":disabled"),e&&(d.groupField=d.groupField||"group",g[d.groupField]=e),c.push(g)}var c=[],d=a(b).combobox("options");return a(b).children().each(function(){if(this.tagName.toLowerCase()=="optgroup"){var b=a(this).attr("label");a(this).children().each(function(){e(this,b)})}else e(this)}),c},a.fn.combobox.defaults=a.extend({},a.fn.combo.defaults,{valueField:"value",textField:"text",groupField:null,groupFormatter:function(a){return a},mode:"local",method:"post",url:null,data:null,keyHandler:{up:function(a){e(this,"prev"),a.preventDefault()},down:function(a){e(this,"next"),a.preventDefault()},left:function(a){},right:function(a){},enter:function(a){l(this)},query:function(a,b){k(this,a)}},filter:function(b,c){var d=a(this).combobox("options");return c[d.textField].toLowerCase().indexOf(b.toLowerCase())==0},formatter:function(b){var c=a(this).combobox("options");return b[c.textField]},loader:function(b,c,d){var e=a(this).combobox("options");if(!e.url)return!1;a.ajax({type:e.method,url:e.url,data:b,dataType:"json",success:function(a){c(a)},error:function(){d.apply(this,arguments)}})},loadFilter:function(a){return a},finder:{getEl:function(b,d){var e=c(b,d),f=a.data(b,"combobox").itemIdPrefix+"_"+e;return a("#"+f)},getRow:function(b,d){var e=a.data(b,"combobox"),f=d instanceof jQuery?d.attr("id").substr(e.itemIdPrefix.length+1):c(b,d);return e.data[parseInt(f)]}},onBeforeLoad:function(a){},onLoadSuccess:function(){},onLoadError:function(){},onSelect:function(a){},onUnselect:function(a){}})})(jQuery)