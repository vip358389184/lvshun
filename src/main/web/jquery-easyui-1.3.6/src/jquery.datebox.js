/**
 * jQuery EasyUI 1.3.6
 * 
 * Copyright (c) 2009-2014 www.jeasyui.com. All rights reserved.
 *
 * Licensed under the GPL license: http://www.gnu.org/licenses/gpl.txt
 * To use it on other terms please contact us at info@jeasyui.com
 *
 */

(function(a){function b(b){function f(){var f=a(b).combo("panel").css("overflow","hidden");f.panel("options").onBeforeDestroy=function(){var b=a(this).find(".calendar-shared");b.length&&b.insertBefore(b[0].pholder)};var g=a('<div class="datebox-calendar-inner"></div>').appendTo(f);if(d.sharedCalendar){var h=a(d.sharedCalendar);h[0].pholder||(h[0].pholder=a('<div class="calendar-pholder" style="display:none"></div>').insertAfter(h)),h.addClass("calendar-shared").appendTo(g),h.hasClass("calendar")||h.calendar(),c.calendar=h}else c.calendar=a("<div></div>").appendTo(g).calendar();a.extend(c.calendar.calendar("options"),{fit:!0,border:!1,onSelect:function(c){var d=a(this.target).datebox("options");e(this.target,d.formatter.call(this.target,c)),a(this.target).combo("hidePanel"),d.onSelect.call(b,c)}});var i=a('<div class="datebox-button"><table cellspacing="0" cellpadding="0" style="width:100%"><tr></tr></table></div>').appendTo(f),j=i.find("tr");for(var k=0;k<d.buttons.length;k++){var l=a("<td></td>").appendTo(j),m=d.buttons[k],n=a('<a href="javascript:void(0)"></a>').html(a.isFunction(m.text)?m.text(b):m.text).appendTo(l);n.bind("click",{target:b,handler:m.handler},function(a){a.data.handler.call(this,a.data.target)})}j.find("td").css("width",100/d.buttons.length+"%")}function g(){var e=a(b).combo("panel"),f=e.children("div.datebox-calendar-inner");e.children()._outerWidth(e.width()),c.calendar.appendTo(f),c.calendar[0].target=b;if(d.panelHeight!="auto"){var g=e.height();e.children().not(f).each(function(){g-=a(this).outerHeight()}),f._outerHeight(g)}c.calendar.calendar("resize")}var c=a.data(b,"datebox"),d=c.options;a(b).addClass("datebox-f").combo(a.extend({},d,{onShowPanel:function(){g(),e(b,a(b).datebox("getText"),!0),d.onShowPanel.call(b)}})),a(b).combo("textbox").parent().addClass("datebox"),c.calendar||f(),e(b,d.value)}function c(a,b){e(a,b,!0)}function d(b){var c=a.data(b,"datebox"),d=c.options,f=c.calendar.calendar("options").current;f&&(e(b,d.formatter.call(b,f)),a(b).combo("hidePanel"))}function e(b,c,d){var e=a.data(b,"datebox"),f=e.options,g=e.calendar;a(b).combo("setValue",c),g.calendar("moveTo",f.parser.call(b,c)),d||(c?(c=f.formatter.call(b,g.calendar("options").current),a(b).combo("setValue",c).combo("setText",c)):a(b).combo("setText",c))}a.fn.datebox=function(c,d){if(typeof c=="string"){var e=a.fn.datebox.methods[c];return e?e(this,d):this.combo(c,d)}return c=c||{},this.each(function(){var d=a.data(this,"datebox");d?a.extend(d.options,c):a.data(this,"datebox",{options:a.extend({},a.fn.datebox.defaults,a.fn.datebox.parseOptions(this),c)}),b(this)})},a.fn.datebox.methods={options:function(b){var c=b.combo("options");return a.extend(a.data(b[0],"datebox").options,{originalValue:c.originalValue,disabled:c.disabled,readonly:c.readonly})},calendar:function(b){return a.data(b[0],"datebox").calendar},setValue:function(a,b){return a.each(function(){e(this,b)})},reset:function(b){return b.each(function(){var b=a(this).datebox("options");a(this).datebox("setValue",b.originalValue)})}},a.fn.datebox.parseOptions=function(b){return a.extend({},a.fn.combo.parseOptions(b),a.parser.parseOptions(b,["sharedCalendar"]))},a.fn.datebox.defaults=a.extend({},a.fn.combo.defaults,{panelWidth:180,panelHeight:"auto",sharedCalendar:null,keyHandler:{up:function(a){},down:function(a){},left:function(a){},right:function(a){},enter:function(a){d(this)},query:function(a,b){c(this,a)}},currentText:"Today",closeText:"Close",okText:"Ok",buttons:[{text:function(b){return a(b).datebox("options").currentText},handler:function(b){a(b).datebox("calendar").calendar({year:(new Date).getFullYear(),month:(new Date).getMonth()+1,current:new Date}),d(b)}},{text:function(b){return a(b).datebox("options").closeText},handler:function(b){a(this).closest("div.combo-panel").panel("close")}}],formatter:function(a){var b=a.getFullYear(),c=a.getMonth()+1,d=a.getDate();return c+"/"+d+"/"+b},parser:function(a){var b=Date.parse(a);return isNaN(b)?new Date:new Date(b)},onSelect:function(a){}})})(jQuery)